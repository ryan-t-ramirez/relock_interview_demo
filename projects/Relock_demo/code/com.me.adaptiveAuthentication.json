{
	"nodes": [
		{
			"id": "startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f",
			"type": "startNode",
			"sourcePosition": "right",
			"position": {
				"x": -278.850455403498,
				"y": 29.724016490354103
			},
			"deletable": false,
			"data": {
				"id": "startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f",
				"type": "startNode",
				"position": {
					"x": 30,
					"y": 40
				},
				"agamaData": {
					"isTopLevelFlow": true,
					"basepath": "",
					"configParams": "{}",
					"nodeIcon": "material-symbols:line-start-square",
					"timeout": "",
					"inputs": "",
					"configs": "",
					"flowname": "com.me.adaptiveAuthentication",
					"displayName": "Adaptive Authentication",
					"creationDate": "06/09/2025",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
			"type": "rrfNode",
			"position": {
				"x": -51.78233997101919,
				"y": 29.724016490354117
			},
			"data": {
				"id": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
				"type": "rrfNode",
				"position": {
					"x": 278,
					"y": 33
				},
				"previousNodeId": "startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f",
				"agamaData": {
					"assignments": [],
					"nodeIcon": "ph:globe-simple",
					"templatePath": "auth/userLogin.html",
					"asssignedVariableName": "flow_userLogin",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Prompt for Username",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
			"type": "rrfNode",
			"position": {
				"x": 546.2194223304971,
				"y": 291
			},
			"data": {
				"id": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
				"type": "rrfNode",
				"position": {
					"x": 778,
					"y": 291
				},
				"previousNodeId": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
				"branching": "success",
				"agamaData": {
					"assignments": [],
					"nodeIcon": "ph:globe-simple",
					"templatePath": "auth/password.html",
					"asssignedVariableName": "flow_password",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Prompt for Password",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
			"type": "rrfNode",
			"position": {
				"x": 780.329467172937,
				"y": 292.16473358646846
			},
			"data": {
				"id": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
				"type": "rrfNode",
				"position": {
					"x": 1028,
					"y": 291
				},
				"previousNodeId": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
				"agamaData": {
					"assignments": [],
					"nodeIcon": "ph:globe-simple",
					"templatePath": "auth/otp.html",
					"asssignedVariableName": "flow_otp",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Prompt for OTP",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false,
			"dragging": false
		},
		{
			"id": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
			"type": "rrfNode",
			"position": {
				"x": 528,
				"y": -159
			},
			"data": {
				"id": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
				"type": "rrfNode",
				"position": {
					"x": 778,
					"y": -159
				},
				"previousNodeId": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
				"branching": "otherwise",
				"agamaData": {
					"assignments": [],
					"nodeIcon": "ph:globe-simple",
					"templatePath": "auth/password.html",
					"asssignedVariableName": "flow_password",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Prompt for Password (Low Risk)",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false
		},
		{
			"id": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
			"type": "callNode",
			"position": {
				"x": 778,
				"y": -159
			},
			"data": {
				"id": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
				"type": "callNode",
				"position": {
					"x": 1028,
					"y": -159
				},
				"previousNodeId": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
				"agamaData": {
					"javaClassName": "com.Relock.auth.Authenticator",
					"javaMethodName": "verifyPassword",
					"javaVariableName": "",
					"exceptionVariableField": "",
					"callType": "Call static method",
					"arguments": [
						"flow_userLogin",
						"flow_password"
					],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Verify Credentials",
					"hasComment": true,
					"comment": "",
					"asssignedVariableName": "flow_authResult"
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false
		},
		{
			"id": "finishNode-5ed92952-e1ba-4201-8d98-7001b3d3f09a",
			"type": "finishNode",
			"position": {
				"x": 1028,
				"y": -159
			},
			"data": {
				"id": "finishNode-5ed92952-e1ba-4201-8d98-7001b3d3f09a",
				"type": "finishNode",
				"position": {
					"x": 1278,
					"y": -159
				},
				"previousNodeId": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
				"agamaData": {
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Login Successful (Low Risk)",
					"hasComment": true,
					"comment": "",
					"flowfilename": "",
					"returnVariable": "{ userId: flow_userLogin }",
					"finishMode": "withSuccess",
					"nodeIcon": "material-symbols:line-end-square-rounded"
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false
		},
		{
			"id": "callNode-81422a28-c879-4517-81ac-7c491191f993",
			"type": "callNode",
			"position": {
				"x": 1030.329467172937,
				"y": 292.16473358646846
			},
			"data": {
				"id": "callNode-81422a28-c879-4517-81ac-7c491191f993",
				"type": "callNode",
				"position": {
					"x": 1280.329467172937,
					"y": 292.16473358646846
				},
				"previousNodeId": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
				"agamaData": {
					"javaClassName": "com.Relock.auth.Authenticator",
					"javaMethodName": "verifyPasswordAndOTP",
					"javaVariableName": "",
					"exceptionVariableField": "",
					"callType": "Call static method",
					"arguments": [
						"flow_userLogin",
						"flow_password",
						"flow_otp"
					],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Verify Credentials (High Risk)",
					"hasComment": true,
					"comment": "",
					"asssignedVariableName": "flow_authResult"
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false
		},
		{
			"id": "finishNode-6eb945d2-7d02-4eeb-a3cd-0dc4d77b3b49",
			"type": "finishNode",
			"position": {
				"x": 1280.329467172937,
				"y": 292.16473358646846
			},
			"data": {
				"id": "finishNode-6eb945d2-7d02-4eeb-a3cd-0dc4d77b3b49",
				"type": "finishNode",
				"position": {
					"x": 1530.329467172937,
					"y": 292.16473358646846
				},
				"previousNodeId": "callNode-81422a28-c879-4517-81ac-7c491191f993",
				"agamaData": {
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Login Successful",
					"hasComment": true,
					"comment": "",
					"flowfilename": "",
					"returnVariable": "{ userId: flow_userLogin }",
					"finishMode": "withSuccess",
					"nodeIcon": "material-symbols:line-end-square-rounded"
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": false
		},
		{
			"id": "callNode-92d37a37-31fb-4117-8247-32d61d059027",
			"type": "callNode",
			"position": {
				"x": 198.21766002898082,
				"y": 29.724016490354117
			},
			"data": {
				"id": "callNode-92d37a37-31fb-4117-8247-32d61d059027",
				"type": "callNode",
				"position": {
					"x": 198.21766002898082,
					"y": 29.724016490354117
				},
				"previousNodeId": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
				"agamaData": {
					"javaClassName": "com.Relock.risk.RiskChecker",
					"javaMethodName": "analyze",
					"javaVariableName": "",
					"exceptionVariableField": "",
					"callType": "Call static method",
					"arguments": [
						"flow_userLogin"
					],
					"nodeIcon": "material-symbols:code",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "Assess Login Risk",
					"hasComment": true,
					"comment": "// ---  Risk-Scoring Protocol---\n\nCONST RISK_THRESHOLD = 100\n\nFUNCTION analyze(username, request_context):\n  \n  risk_score = 0\n  \n  // 1. Check IP Reputation (High Impact)\n  IF is_ip_blacklisted(request_context.ip_address) \nTHEN\n    risk_score += 90\n  END IF\n\n  // 2. Check for New Device (High Impact)\n  IF is_new_device_for_user(username, request_context.device_fingerprint) THEN\n    risk_score += 75\n  END IF\n  \n  // 3. Check for Impossible Travel (Critical Impact)\n  IF is_impossible_travel(username, request_context.location) \nTHEN\n    risk_score += 150\n  END IF\n  \n  // 4. Check for Atypical Login Time (Medium Impact)\n  IF is_atypical_login_time(username, request_context.timestamp) \nTHEN\n    risk_score += 30\n  END IF\n  \n  // 5. Final Decision\n  IF risk_score >= RISK_THRESHOLD \nTHEN\n    RETURN \"high\"\n\n  ELSE\n    RETURN \"low\"\n  END IF",
					"asssignedVariableName": "flow_riskLevel"
				}
			},
			"measured": {
				"width": 170,
				"height": 124
			},
			"selected": true
		},
		{
			"id": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
			"type": "whenNode",
			"position": {
				"x": 366.9310065544555,
				"y": 87.11804038866272
			},
			"data": {
				"id": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
				"type": "whenNode",
				"position": {
					"x": 448.21766002898084,
					"y": 87.72401649035412
				},
				"previousNodeId": "callNode-92d37a37-31fb-4117-8247-32d61d059027",
				"agamaData": {
					"variableField": "",
					"valueField": "",
					"conditionInputField": "",
					"conditions": [
						{
							"variable": "flow_riskLevel",
							"operator": "is",
							"dataValue": "high",
							"combinator": "none"
						}
					],
					"nodeIcon": "ph:swap",
					"nodeColor": "",
					"titleColor": "",
					"descColor": "",
					"displayName": "",
					"hasComment": true,
					"comment": ""
				}
			},
			"measured": {
				"width": 110,
				"height": 60
			},
			"selected": false,
			"dragging": false
		}
	],
	"edges": [
		{
			"id": "startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f-rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
			"type": "default",
			"source": "startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f",
			"target": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_startNode-ac2ce70e-771a-43c7-8425-2ea019e0190f"
		},
		{
			"id": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12-rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
			"type": "default",
			"source": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
			"target": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12"
		},
		{
			"id": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62-callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
			"type": "default",
			"source": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
			"target": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62"
		},
		{
			"id": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295-finishNode-5ed92952-e1ba-4201-8d98-7001b3d3f09a",
			"type": "default",
			"source": "callNode-b1bad61e-99f8-4faa-8067-0859a85c1295",
			"target": "finishNode-5ed92952-e1ba-4201-8d98-7001b3d3f09a",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_callNode-b1bad61e-99f8-4faa-8067-0859a85c1295"
		},
		{
			"id": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1-callNode-81422a28-c879-4517-81ac-7c491191f993",
			"type": "default",
			"source": "rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1",
			"target": "callNode-81422a28-c879-4517-81ac-7c491191f993",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_rrfNode-f62babf7-b6db-41db-992d-3e47a96418a1"
		},
		{
			"id": "callNode-81422a28-c879-4517-81ac-7c491191f993-finishNode-6eb945d2-7d02-4eeb-a3cd-0dc4d77b3b49",
			"type": "default",
			"source": "callNode-81422a28-c879-4517-81ac-7c491191f993",
			"target": "finishNode-6eb945d2-7d02-4eeb-a3cd-0dc4d77b3b49",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_callNode-81422a28-c879-4517-81ac-7c491191f993"
		},
		{
			"id": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d-callNode-92d37a37-31fb-4117-8247-32d61d059027",
			"type": "default",
			"source": "rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d",
			"target": "callNode-92d37a37-31fb-4117-8247-32d61d059027",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_rrfNode-28a3fb53-4498-443e-94b7-c484f88dde0d"
		},
		{
			"id": "callNode-92d37a37-31fb-4117-8247-32d61d059027-whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
			"type": "default",
			"source": "callNode-92d37a37-31fb-4117-8247-32d61d059027",
			"target": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"label": "",
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"labelShowBg": true,
			"sourceHandle": "source_callNode-92d37a37-31fb-4117-8247-32d61d059027"
		},
		{
			"source": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
			"sourceHandle": "source_whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c_success",
			"target": "rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
			"targetHandle": "target_rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12",
			"label": "Condition met",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"id": "xy-edge__whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4csource_whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c_success-rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12target_rrfNode-d3a5a423-37d5-441b-bf2b-8c31d99e3e12"
		},
		{
			"source": "whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c",
			"sourceHandle": "source_whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c_otherwise",
			"target": "rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
			"targetHandle": "target_rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62",
			"label": "otherwise",
			"labelBgPadding": [
				8,
				4
			],
			"labelBgBorderRadius": 4,
			"labelBgStyle": {
				"fill": "#009688",
				"color": "#ffffff",
				"fillOpacity": 0.7
			},
			"id": "xy-edge__whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4csource_whenNode-4f75bdf7-db02-4c65-a04d-f3336223ac4c_otherwise-rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62target_rrfNode-008e6f5a-6c11-4c7f-b631-185783c7cc62"
		}
	],
	"viewport": {
		"x": 173.10707583604506,
		"y": 208.75669232326936,
		"zoom": 0.6722335285165116
	}
}