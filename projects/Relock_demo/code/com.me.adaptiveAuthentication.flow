Flow com.me.adaptiveAuthentication
     Basepath ""
flow_userLogin = RRF "auth/userLogin.html" 
flow_riskLevel = Call com.Relock.risk.RiskChecker#analyze flow_userLogin
When flow_riskLevel is high
     flow_password = RRF "auth/password.html" 
     flow_otp = RRF "auth/otp.html" 
     flow_authResult = Call com.Relock.auth.Authenticator#verifyPasswordAndOTP flow_userLogin flow_password flow_otp
     it_joekm = {success:true, data: { userId: flow_userLogin }}
     Finish it_joekm
Otherwise
     flow_password = RRF "auth/password.html" 
     flow_authResult = Call com.Relock.auth.Authenticator#verifyPassword flow_userLogin flow_password
     it_kloag = {success:true, data: { userId: flow_userLogin }}
     Finish it_kloag